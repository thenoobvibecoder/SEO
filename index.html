<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SEO Analyzer</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
        form { margin-bottom: 20px; }
        input, textarea, button { padding: 10px; margin: 5px 0; width: 100%; box-sizing: border-box; }
        textarea { height: 200px; }
        #results { display: none; }
        #error { color: red; }
        #loading { display: none; font-style: italic; }
        .section { margin-top: 20px; border-top: 1px solid #ddd; padding-top: 10px; }
        ul { list-style-type: disc; padding-left: 20px; }
    </style>
</head>
<body>
    <h1>SEO Analyzer</h1>
    <p>Enter your content details to analyze SEO score, get improvement suggestions, an optimized slug, meta description, and more. Supports HTML content with tags, styling (e.g., &lt;strong&gt;, &lt;em&gt;), embedded images (&lt;img&gt;), and auto-detects primary keyword if not provided.</p>
    <form id="seoForm">
        <label for="title">Page Title:</label>
        <input type="text" id="title" required placeholder="e.g., My Awesome Blog Post">

        <label for="primaryKeyword">Primary Keyword (optional - will auto-detect if blank):</label>
        <input type="text" id="primaryKeyword" placeholder="e.g., seo tips">

        <label for="content">Content (paste your HTML or plain text article here):</label>
        <textarea id="content" required></textarea>

        <button type="submit">Analyze SEO</button>
    </form>
    
    <p id="loading">Analyzing...</p>
    <p id="error"></p>
    
    <div id="results">
        <h2>Analysis Results</h2>
        
        <div class="section">
            <h3>Detected Primary Keyword</h3>
            <p id="detectedKeyword"></p>
        </div>
        
        <div class="section">
            <h3>SEO Score</h3>
            <p id="seoScore"></p>
        </div>
        
        <div class="section">
            <h3>Improvement Instructions</h3>
            <ul id="improvements"></ul>
        </div>
        
        <div class="section">
            <h3>SEO-Optimized Slug</h3>
            <p id="slug"></p>
        </div>
        
        <div class="section">
            <h3>Meta Description</h3>
            <p id="metaDesc"></p>
        </div>
        
        <div class="section">
            <h3>Other SEO Recommendations</h3>
            <ul id="otherRecs"></ul>
        </div>
    </div>

    <script>
        const form = document.getElementById('seoForm');
        const loading = document.getElementById('loading');
        const error = document.getElementById('error');
        const results = document.getElementById('results');
        const detectedKeywordEl = document.getElementById('detectedKeyword');
        const seoScoreEl = document.getElementById('seoScore');
        const improvementsEl = document.getElementById('improvements');
        const slugEl = document.getElementById('slug');
        const metaDescEl = document.getElementById('metaDesc');
        const otherRecsEl = document.getElementById('otherRecs');

        form.addEventListener('submit', (e) => {
            e.preventDefault();
            error.textContent = '';
            results.style.display = 'none';
            loading.style.display = 'block';
            improvementsEl.innerHTML = '';
            otherRecsEl.innerHTML = '';

            const title = document.getElementById('title').value.trim();
            let primaryKeyword = document.getElementById('primaryKeyword').value.trim().toLowerCase();
            const content = document.getElementById('content').value.trim();

            if (!title || !content) {
                error.textContent = 'Title and content are required.';
                loading.style.display = 'none';
                return;
            }

            // Simulate async analysis (for UX)
            setTimeout(() => {
                try {
                    // Parse content as HTML
                    const parser = new DOMParser();
                    const doc = parser.parseFromString(content, 'text/html');
                    const body = doc.body;

                    // Extract clean text (strip tags but preserve for analysis)
                    const fullText = body.textContent.trim();
                    const words = fullText.split(/\s+/).filter(word => word.length > 0);
                    const wordCount = words.length;

                    // Auto-detect primary keyword if not provided
                    if (!primaryKeyword) {
                        const topKeywords = getTopKeywords(words);
                        primaryKeyword = topKeywords[0] || ''; // Take the most frequent
                    }

                    // Keyword Density (consider emphasized text as bonus)
                    let keywordCount = words.filter(word => word.toLowerCase().includes(primaryKeyword.split(' ')[0])).length;
                    const emphasizedKeywords = body.querySelectorAll('strong, em, b, i');
                    emphasizedKeywords.forEach(el => {
                        if (el.textContent.toLowerCase().includes(primaryKeyword)) keywordCount += 0.5; // Bonus for emphasis
                    });
                    const density = (keywordCount / wordCount) * 100;

                    // Headings
                    const h1Count = body.querySelectorAll('h1').length;
                    const h2Count = body.querySelectorAll('h2').length;

                    // Readability (Flesch-Kincaid approx)
                    const sentences = fullText.split(/[.!?]+/).length || 1;
                    const syllables = words.reduce((acc, word) => acc + (word.match(/[aeiouy]{1,2}/gi) || []).length, 0);
                    const flesch = 206.835 - 1.015 * (wordCount / sentences) - 84.6 * (syllables / wordCount);

                    // Images
                    const images = body.querySelectorAll('img');
                    const imageCount = images.length;
                    let altWithKeyword = 0;
                    images.forEach(img => {
                        if (img.alt && img.alt.toLowerCase().includes(primaryKeyword)) altWithKeyword++;
                    });

                    // Score Calculation (0-100)
                    let score = 0;
                    if (wordCount > 300) score += 20;
                    if (density > 1 && density < 3) score += 20;
                    if (h1Count >= 1) score += 10;
                    if (h2Count >= 2) score += 10;
                    if (flesch > 60) score += 15;
                    if (imageCount > 0) score += 10;
                    if (altWithKeyword > 0) score += 15;

                    // Improvements
                    const improvements = [];
                    if (wordCount < 300) improvements.push('Increase content length to at least 300 words for better SEO.');
                    if (density < 1) improvements.push('Increase keyword density to 1-3% by naturally incorporating the primary keyword.');
                    if (density > 3) improvements.push('Reduce keyword density to avoid stuffing; aim for 1-3%.');
                    if (h1Count < 1) improvements.push('Add at least one H1 heading containing the primary keyword.');
                    if (h2Count < 2) improvements.push('Add more H2 subheadings for better structure.');
                    if (flesch < 60) improvements.push('Improve readability by using shorter sentences and simpler words.');
                    if (imageCount === 0) improvements.push('Add images to make the content more engaging.');
                    if (altWithKeyword === 0 && imageCount > 0) improvements.push('Include the primary keyword in image alt texts for better SEO.');

                    // Slug
                    const slug = title.toLowerCase().replace(/[^a-z0-9]+/g, '-').replace(/^-|-$/g, '');

                    // Meta Description (first 160 chars of clean text)
                    const metaDesc = fullText.substring(0, 160).trim() + (fullText.length > 160 ? '...' : '');

                    // Other Recs
                    const otherRecs = [
                        `Suggested Title: ${primaryKeyword.charAt(0).toUpperCase() + primaryKeyword.slice(1)} - ${title}`,
                        'Include internal/external links for better authority.',
                        'Ensure mobile-friendliness (use responsive design).',
                        'Optimize images for speed if applicable.',
                        `Top Keywords: ${getTopKeywords(words).join(', ')}`,
                        `Detected Images: ${imageCount} (with ${altWithKeyword} having keyword in alt text)`,
                        `Emphasized Keywords: Found ${emphasizedKeywords.length} styled elements, boosting density calculation.`
                    ];

                    // Display
                    detectedKeywordEl.textContent = primaryKeyword || 'None detected';
                    seoScoreEl.textContent = `${score}/100`;
                    improvements.forEach(rec => {
                        const li = document.createElement('li');
                        li.textContent = rec;
                        improvementsEl.appendChild(li);
                    });
                    slugEl.textContent = `/${slug}`;
                    metaDescEl.textContent = metaDesc;
                    otherRecs.forEach(rec => {
                        const li = document.createElement('li');
                        li.textContent = rec;
                        otherRecsEl.appendChild(li);
                    });

                    results.style.display = 'block';
                } catch (err) {
                    error.textContent = `Error: ${err.message}`;
                } finally {
                    loading.style.display = 'none';
                }
            }, 500); // Fake delay
        });

        function getTopKeywords(words) {
            const freq = {};
            words.forEach(word => {
                word = word.toLowerCase().replace(/[^a-z]/g, '');
                if (word.length > 3) freq[word] = (freq[word] || 0) + 1;
            });
            return Object.keys(freq).sort((a, b) => freq[b] - freq[a]).slice(0, 5);
        }
    </script>
</body>
</html>
